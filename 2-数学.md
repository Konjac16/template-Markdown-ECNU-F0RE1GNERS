# 数学

## 类欧几里得

* $m = \lfloor \frac{an+b}{c} \rfloor$.
* $f(a,b,c,n)=\sum_{i=0}^n\lfloor\frac{ai+b}{c}\rfloor$: 当 $a \ge c$ or $b \ge c$ 时，$f(a,b,c,n)=(\frac{a}{c})n(n+1)/2+(\frac{b}{c})(n+1)+f(a \bmod c,b \bmod c,c,n)$；否则 $f(a,b,c,n)=nm-f(c,c-b-1,a,m-1)$。
* $g(a,b,c,n)=\sum_{i=0}^n i \lfloor\frac{ai+b}{c}\rfloor$: 当 $a \ge c$ or $b \ge c$ 时，$g(a,b,c,n)=(\frac{a}{c})n(n+1)(2n+1)/6+(\frac{b}{c})n(n+1)/2+g(a \bmod c,b \bmod c,c,n)$；否则 $g(a,b,c,n)=\frac{1}{2} (n(n+1)m-f(c,c-b-1,a,m-1)-h(c,c-b-1,a,m-1))$。
* $h(a,b,c,n)=\sum_{i=0}^n\lfloor \frac{ai+b}{c} \rfloor^2$: 当 $a \ge c$ or $b \ge c$ 时，$h(a,b,c,n)=(\frac{a}{c})^2 n(n+1)(2n+1)/6 +(\frac{b}{c})^2 (n+1)+(\frac{a}{c})(\frac{b}{c})n(n+1)+h(a \bmod c, b \bmod c,c,n)+2(\frac{a}{c})g(a \bmod c,b \bmod c,c,n)+2(\frac{b}{c})f(a \bmod c,b \bmod c,c,n)$；否则 $h(a,b,c,n)=nm(m+1)-2g(c,c-b-1,a,m-1)-2f(c,c-b-1,a,m-1)-f(a,b,c,n)$。

## excrt
```cpp
int n,m;
int a[N],b[N];
int exgcd(int a,int b,int &x,int &y){
	if(b==0){x=1,y=0;return a;}
	int d=exgcd(b,a%b,x,y);
	int z=x;x=y,y=z-a/b*y;
	
	return d;
}
inline int mul(int a,int b,int mod){
	int res=0;
	for(;b;b>>=1){
		if(b&1)res=(res+a)%mod;
		a=(a<<1)%mod;
	}
	return res;
}
inline int excrt(){
	int ans=b[1];m=a[1];
	For(i,2,n){
		int t,y,c=((b[i]-ans)%a[i]+a[i])%a[i];
		int d=exgcd(m,a[i],t,y);
		// t=t*(c/d);
		t=mul(t,c/d,a[i]);
		ans+=t*m;
		m=lcm(m,a[i]);
		ans=(ans%m+m)%m;
	}
	int res=(ans%m+m)%m;
	return res;
}
signed main()
{
	n=read();
	For(i,1,n)a[i]=read(),b[i]=read();
	write(excrt());
	return 0;
}
/*
x=b[i](mod a[i])
*/
```

## gauss

```cpp
int n,m;
double a[N][N];
inline void gauss(){
	For(i,1,n){
		int F=0;
		For(j,i,n)if(a[j][i]){
			For(k,1,m)swap(a[i][k],a[j][k]);
			F=1; break;
		}
		if(!F)For(j,1,i-1)if(a[j][i]&&a[i][i]==0){
			For(k,1,m)swap(a[i][k],a[j][k]);
			F=1; break;	
		}
		if(!F)continue;
		double tt=a[i][i];
		For(k,i,m)a[i][k]/=tt;
		For(j,1,n)if(j!=i){
			tt=a[j][i];
			For(k,i,m)a[j][k]-=tt*a[i][k];
		}
	}
	For(i,1,n)if(a[i][i]==0&&a[i][m]){write(-1,'\n');return;}
	For(i,1,n)if(a[i][i]==0&&a[i][m]==0){write(0,'\n');return;}
	For(i,1,n)printf("x%lld=%0.2lf\n",i,a[i][m]);
}
signed main()
{
	n=read(),m=n+1;
	For(i,1,n)For(j,1,m)cin>>a[i][j];
	gauss();
	return 0;
}
/*
a[1][1]*x1+a[1][2]*x2+...+a[1][n]*xn=b1
a[2][1]*x1+a[2][2]*x2+...+a[2][n]*xn=b2
无解-1
无穷解0
*/
```
## 线性筛
```cpp
phi[1]=1,mu[1]=1;
For(i,2,N-1){
  if(!vis[i]){p[++tot]=i,phi[i]=i-1,mu[i]=-1;}
  for(int j=1;j<=tot&&i*p[j]<N;++j){
    vis[i*p[j]]=1;
    if(i%p[j]!=0){
      phi[i*p[j]]=phi[i]*(p[j]-1);
      mu[i*p[j]]=-mu[i];
    }else{
      phi[i*p[j]]=phi[i]*p[j],mu[i*p[j]]=0;
      break;
    }
  }
}
```

